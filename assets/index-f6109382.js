import{u as w,a as B,R as b,j as c,T as J,b as V,c as e,d as O,e as Y,f as q,F as A,C as K,g as Z,I as Q,S as X,H as N,h as ee,A as te,i as ae,B as R,k as z,l as S,M as D,r as u,m as ne,n as P,o as G,p as re,L,q as se,s as W,t as oe,v as ie,w as le,x as ce,y as de,z as ue,D as me,E as he,G as pe,J as ge,K as fe,N as ye,O as be,P as we,Q as ve,U as Re,V as Se,W as Ae,X as Le,Y as Pe,Z as Me,_ as Ce,$ as Te,a0 as Ee,a1 as x,a2 as I,a3 as k,a4 as Oe,a5 as xe,a6 as Ie,a7 as ke,a8 as _e,a9 as je,aa as Be,ab as Ne}from"./vendor-0f96819f.js";function dt(){import.meta.url,import("_").catch(()=>1);async function*a(){}}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function l(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=l(t);fetch(t.href,r)}})();var M=(a=>(a.APP_LOAD="APP_LOAD",a.UPLOAD_TEMPLATES="UPLOAD_TEMPLATES",a))(M||{});const ze="Hi RMP team! I would like to contribute to the gallery with the data below.",De="**Do not edit lines below, they are meant for bots only!!!**";function Ge(){const{t:a,i18n:{language:o}}=w(),l=B(),s=()=>{u.isStandaloneWindow()?l("/new"):u.openApp("rmg-templates-upload"),u.event(M.UPLOAD_TEMPLATES,{})},[t,r]=b.useState({});return b.useEffect(()=>{fetch("resources/real_world.json").then(n=>n.json()).then(n=>r(n))},[]),c(J,{isLazy:!0,isFitted:!0,children:[c(V,{children:[e(O,{children:a("gallery.type.realWorld")}),e(O,{isDisabled:!0,children:a("gallery.type.fantasy")})]}),e(Y,{children:e(q,{children:c(A,{flexWrap:"wrap",children:[Object.keys(t).map(n=>c(K,{variant:"elevated",minWidth:"300",m:"2",children:[c(Z,{children:[e(Q,{src:`resources/thumbnails/${n}@300.png`,alt:n,borderRadius:"lg"}),e(X,{mt:"6",spacing:"3",children:e(N,{size:"lg",children:t[n].name[o]})})]}),c(ee,{children:[e(te,{children:t[n].contributors.map(p=>e(ae,{src:`https://avatars.githubusercontent.com/u/${p}`},p))}),e(R,{variant:"solid",colorScheme:"blue",ml:"auto",isDisabled:!0,children:"Set"})]})]},n)),e(z,{onClick:s,position:"fixed",bottom:"20px",right:"20px",zIndex:3,children:e(S,{"aria-label":"new",size:"lg",icon:e(D,{}),colorScheme:"blue",variant:"solid"})})]})})})]})}const We=a=>new Promise(o=>{const l=new FileReader;l.onloadend=()=>o(l.result),l.readAsText(a)}),_=(a,o,l)=>{if(o!==null){const s=document.createElement("details");return s.setAttribute("repo","rmp-gallery"),s.setAttribute("type",a),Object.entries(l).forEach(([t,r])=>{s.setAttribute(t,r)}),s.textContent=o,s.outerHTML}else return""};function He(){const{i18n:a}=w();return o=>{var l,s;return(s=(l=a.languages.map(t=>o[t]).find(t=>t!==void 0))!=null?l:o.en)!=null?s:"(Translation Error)"}}const Ue={"& > div:first-of-type":{flex:1}};function Fe(a){const{translations:o,onUpdate:l,onLangSwitch:s,onRemove:t}=a,{t:r}=w(),n=He(),p=(m,g)=>[{type:"select",label:r("Language"),value:m,options:Object.entries(L).reduce((i,f)=>({...i,[f[0]]:n(f[1])}),{}),disabledOptions:o.filter(i=>i[0]!==m).map(i=>i[0]),onChange:i=>s(m,i)},{type:"input",label:r("Name"),value:g,onChange:i=>l(m,i),validator:i=>!!i}],v=()=>{const m=Object.keys(L).filter(g=>!o.find(i=>i[0]===g))[0];l(m,"")};return e(ne,{direction:"column",children:o.map(([m,g],i,f)=>c(P,{sx:Ue,children:[e(G,{fields:p(m,g),noLabel:i>0}),i===f.length-1?e(S,{size:"sm",variant:"ghost","aria-label":r("Add a name in another language"),title:r("Add a name in another language"),onClick:v,icon:e(D,{})}):e(z,{minW:8}),f.length>1&&e(S,{size:"sm",variant:"ghost","aria-label":r("Remove this name"),title:r("Remove this name"),onClick:()=>t(m),icon:e(re,{})})]},i))})}const $e={px:2,pt:2,width:{base:"100%",md:520},"& > div:first-of-type":{flexDirection:"column",flex:1,overflowY:"auto"},"& > div:nth-of-type(2)":{my:2}};function Je(){var C,T;const{t:a}=w(),o=B(),l=()=>{u.isStandaloneWindow()?o("/"):u.openApp("rmg-templates")},s=b.useRef(null),[t,r]=b.useState(!1),[n,p]=b.useState({name:{en:""},desc:{en:""},reference:"",justification:""}),[v,m]=b.useState(""),g=(T=(C=n.name.en)==null?void 0:C.replace(/[^A-Za-z0-9]/g,"").toLowerCase())!=null?T:"",i=[ze,De,_("metadata",JSON.stringify(n,null,4),{}),_("real_world",v,{compress:"zipson",city:g})].join(`

`),f=new URLSearchParams({labels:"resources",title:`Resources: New template of ${g}`}),U=async d=>{var y;const h=(y=d.target.files)==null?void 0:y[0];if(console.log("handleFileUpload():: received file",h),!!h){if(h.type!=="application/json"){alert("Invalid file type!"),d.target.value="";return}try{const E=await We(h);m(ye.stringify(JSON.parse(E.trim())).trim())}catch(E){alert("Invalid file!"),d.target.value=""}}},F=async()=>{s!=null&&s.current&&(s.current.select(),await navigator.clipboard.writeText(i)),window.open("https://github.com/railmapgen/rmp-gallery/issues/new?"+f.toString(),"_blank")},$=[{type:"custom",label:a("Project file"),component:e(se,{variant:"flushed",size:"xs",type:"file",accept:".json",onChange:U}),minW:250},{type:"input",label:a("Reference link"),placeholder:"Enter the link where you get the valid data",value:n.reference,onChange:d=>p({...n,reference:d}),minW:250},{type:"input",label:a("Justification"),placeholder:"The reason why you make these changes",value:n.justification,onChange:d=>p({...n,justification:d}),minW:250}];return c(W,{sx:$e,children:[c(A,{children:[e(G,{fields:$}),e(oe,{label:a("City Name"),children:e(Fe,{translations:Object.entries(n.name),onUpdate:(d,h)=>p({...n,name:{...n.name,[d]:h}}),onLangSwitch:(d,h)=>{const y=structuredClone(n);y.name[h]=y.name[d],delete y.name[d],p(y)},onRemove:d=>{const h=structuredClone(n);delete h.name[d],p(h)}})})]}),c(A,{children:[e(R,{size:"sm",onClick:l,children:a("Back to list")}),e(P,{ml:"auto",children:e(R,{size:"sm",colorScheme:"primary",isDisabled:v===""||n.reference===""||g==="",onClick:()=>r(!0),children:a("Submit")})})]}),c(ie,{isOpen:t,onClose:()=>r(!1),children:[e(le,{}),c(ce,{children:[e(de,{children:a("Submit template")}),e(ue,{}),c(me,{children:[e(he,{children:a("You may now copy the following text into your new issue's body.")}),e(pe,{mt:"2",mb:"2"}),e(ge,{ref:s,isReadOnly:!0,defaultValue:i,onClick:({target:d})=>d.select()})]}),e(fe,{children:e(R,{colorScheme:"primary",onClick:F,children:a("Copy issue body and open a new issue")})})]})]})]})}function Ve(){const{t:a}=w(),o=u.getEnv(),l=u.getAppVersion(),s=t=>{u.setLanguage(t),u.getI18nInstance().changeLanguage(t)};return c(be,{children:[e(N,{as:"h4",size:"md",children:a("header.about.rmpGallery")}),e(we,{environment:o,version:l}),e(P,{ml:"auto",children:c(ve,{children:[e(Re,{as:S,icon:e(Se,{}),variant:"ghost",size:"sm"}),e(Ae,{children:Le.map(t=>e(Pe,{onClick:()=>s(t),children:L[t][t]},t))})]})})]})}function Ye(){return e(Me,{basename:"/rmp-gallery/",children:e(Ce,{children:c(Te,{children:[e(Ve,{}),e(W,{children:c(Ee,{children:[e(x,{path:"/",element:e(I,{suspenseFallback:e(k,{isIndeterminate:!0}),children:e(Ge,{})})}),e(x,{path:"/new",element:e(I,{suspenseFallback:e(k,{isIndeterminate:!0}),children:e(Je,{})})})]})})]})})})}const qe={counter:0},Ke=Oe({name:"app",initialState:qe,reducers:{bumpCounter:a=>{a.counter++}}}),Ze=Ke.reducer,Qe=xe(),H=Ie({reducer:{app:Ze},middleware:a=>a().prepend(Qe.middleware)});window.rmgStore=H;const Xe={about:{rmpGallery:"RMP Gallery"}},et={type:{realWorld:"Real World",fantasy:"Fantasy"}},tt={header:Xe,gallery:et},at={about:{rmpGallery:"RMP画廊"}},nt={header:at},rt={about:{rmpGallery:"RMP畫廊"}},st={header:rt},ot={about:{rmpGallery:"RMP Gallery"}},it={header:ot},lt=new u.I18nBuilder().use(ke).withAppName("Seed Project").withLng(u.getLanguage()).withResource("en",tt).withResource("zh-Hans",nt).withResource("zh-Hant",st).withResource("ko",it).build();let j;const ct=()=>{j=_e(document.getElementById("root")),j.render(e(je.StrictMode,{children:e(Be,{store:H,children:e(Ne,{i18n:lt,children:e(Ye,{})})})}))};u.ready().then(()=>{ct(),u.injectCss(),u.event(M.APP_LOAD,{})});export{dt as __vite_legacy_guard};
